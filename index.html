<!DOCTYPE html>
<html>
<head>
  <style>
    #canvas {
      position: relative;
      width: 100%;
      height: 100vh;
    }

    .pixel {
      width: 1px;
      height: 1px;
      position: absolute;
    }
  </style>
  <script>
    var canvasWidth;
    var canvasHeight;
    var pixels = {};

    function createPixel() {
      var pixel = document.createElement("div");
      pixel.className = "pixel";
      pixel.style.backgroundColor = getRandomColor();
      document.getElementById("canvas").appendChild(pixel);
      return pixel;
    }

    function movePixel(pixel) {
      var left = parseInt(pixel.style.left) || 0;
      var top = parseInt(pixel.style.top) || 0;
      var currentColor = pixel.style.backgroundColor;

      // Randomly change the pixel's color
      var newColor = getRandomColor();
      pixel.style.backgroundColor = newColor;

      // Check if the pixel was on this position before
      var previousPixel = findPixelAtPosition(left, top);
      if (previousPixel) {
        previousPixel.style.backgroundColor = currentColor;
      }

      // Generate a random direction
      var direction = Math.floor(Math.random() * 4);
      switch (direction) {
        case 0: // Move left
          left = (left - 1 + canvasWidth) % canvasWidth;
          break;
        case 1: // Move right
          left = (left + 1) % canvasWidth;
          break;
        case 2: // Move up
          top = (top - 1 + canvasHeight) % canvasHeight;
          break;
        case 3: // Move down
          top = (top + 1) % canvasHeight;
          break;
      }

      // Update the pixel's position
      pixel.style.left = left + "px";
      pixel.style.top = top + "px";

      // Check if all pixels have been visited
      if (Object.keys(pixels).length === canvasWidth * canvasHeight) {
        resetPixels();
      }
    }

    function resetPixels() {
      // Reset all pixel colors to random
      for (var key in pixels) {
        if (pixels.hasOwnProperty(key)) {
          pixels[key].style.backgroundColor = getRandomColor();
        }
      }
      // Clear the pixels object
      pixels = {};

      // Reset the movement starting point
      var pixel = createPixel();
      pixels[pixel.style.left + "," + pixel.style.top] = pixel;
    }

    function getRandomColor() {
      var letters = "0123456789ABCDEF";
      var color = "#";
      for (var i = 0; i < 6; i++) {
        color += letters[Math.floor(Math.random() * 16)];
      }
      return color;
    }

    function findPixelAtPosition(left, top) {
      var position = left + "," + top;
      return pixels[position];
    }

    function initialize() {
      var canvas = document.getElementById("canvas");
      canvasWidth = canvas.clientWidth;
      canvasHeight = canvas.clientHeight;

      // Create the initial pixel
      var pixel = createPixel();
      pixels[pixel.style.left + "," + pixel.style.top] = pixel;

      // Move the pixel every 0.01 seconds
      setInterval(function() {
        movePixel(pixel);
      }, 10);
    }
  </script>
</head>
<body onload="initialize()">
  <div id="canvas"></div>
</body>
</html>
